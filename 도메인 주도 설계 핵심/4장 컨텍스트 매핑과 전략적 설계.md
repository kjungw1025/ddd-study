# 목차
- [4장 컨텍스트 매핑과 전략적 설계](#4장-컨텍스트-매핑과-전략적-설계)
  - [컨텍스트 매핑](#컨텍스트-매핑)
  - [매핑의 종류](#매핑의-종류)
    - [파트너십](#파트너십)
    - [공유 커널](#공유-커널)
    - [고객-공급자](#고객-공급자)
    - [준수자(Conformist)](#준수자conformist)
    - [반부패 계층(Anticorruption Layer)](#반부패-계층anticorruption-layer)
    - [공개 호스트 서비스(Open Host Service)](#공개-호스트-서비스open-host-service)
    - [공표된 언어](#공표된-언어)
    - [각자의 길(Separate Ways)](#각자의-길separate-ways)
    - [큰 진흙 덩어리](#큰-진흙-덩어리)
  - [컨텍스트 매핑 활용하기](#컨텍스트-매핑-활용하기)
  - [컨텍스트 매핑 사례](#컨텍스트-매핑-사례)

# 4장 컨텍스트 매핑과 전략적 설계
## 컨텍스트 매핑
- `핵심 도메인`에 다른 `바운디드 컨텍스트`와 통합하는 것을 `컨텍스트 매핑`이라 부른다
- 컨텍스트 매핑된 두 바운디드 컨텍스트 사이에는 `통합`뿐만 아니라 팀 간의 다양한 `관계`도 존재할 수 있다

<img src="resources/ch4img1.png" width="800px">

- 2개의 바운디드 컨텍스트 사이의 선이 `컨텍스트 매핑`을 나타낸다

## 매핑의 종류
- 컨텍스트 매핑으로 관계 또는 통합을 표현할 수 있음
> 파트너십
> 
> 공유 커널
> 
> 고객-공급자
> 
> 준수자(Conformist)
> 
> 반부패 계층(Anticorruption Layer)
> 
> 공개 호스트 서비스(Open Host Service)
> 
> 공표된 언어
> 
> 각자의 길(Separate Ways)
> 
> 큰 진흙 덩어리

### 파트너십
<img src="resources/ch4img2.png" width="300px">

> 각 팀은 하나의 `바운디드 컨텍스트`를 책임지고, `일련의 목표`에 대한 의존성을 맞추기 위해 `파트너십`을 구성한다
- 서로 밀접한 관련이 있으므로 상호간 의존적인 작업이나 여러 일정들을 조율하고, 지속적인 통합에 노력해야 한다
- 파트너십이 상호간 이점을 제공한다면 관계를 지속시키고, 서로의 의존성이 줄어들어 이점이 사라진다면 다른 관계로 매핑을 설정해야 한다
- `두 팀 사이에 굵은 매핑 선으로 표시`

### 공유 커널
<img src="resources/ch4img3.png" width="300px">

> 두 바운디드 컨텍스트의 교차 지점으로 표시하는 공유 커널은 `2개 이상` 팀 사이에 `공통인 모델`을 `공유`하는 관계
- 공유하는 모델의 코드, 빌드를 관리하고 테스트하는 것은 한 팀에서 맡아 수행한다

### 고객-공급자
<img src="resources/ch4img4.png" width="300px">

> 2개의 바운디드 컨텍스트와 각 팀들의 관계를 나타내는데 `공급자`는 상류(`U`pstream), `고객`은 하류(`D`ownstream)로 표현한다
- `공급자`는 고객이 원하는 것을 제공해야 하기 때문에 관계를 주도하는 것은 `공급자`
  - 고객이 언제 무엇을 받게 될지는 결국 `공급자`가 결정

### 준수자(Conformist)
<img src="resources/ch4img5.png" width="300px">

> 상류와 하류 팀이 있고, 상류 팀이 하류 팀의 특정 요구에 지원할 동기가 없는 경우에 나타난다
- 하류 팀은 현재의 상류팀 모델을 그대로 따른다
  - 상류 모델의 `보편 언어`를 계속 변환시키는 것은 쉽지 않기 때문
- 확실하게 자리 잡은 거대하고 복잡한 모델과의 통합이 필요할 때 이런 유형이 나타난다
- 예시
  - 아마존과 제휴하는 판매자 중 하나가 아마존 시스템과 통합하려고 할 때, 아마존 모델을 준수하는 경우

### 반부패 계층(Anticorruption Layer)
<img src="resources/ch4img6.png" width="300px">

> 하류 팀이 그들의 보편언어 모델과 상류 팀의 보편언어 모델 사이에 `번역 계층`을 만듦
- `가장 방어적인 컨텍스트 매핑 관계`
- 가능하다면 하류 모델과 상류 통합 모델 사이에 반부패 계층을 만들어야 한다
  - 통합에 용이한 모델 개념들을 만들 수 있음
  - 원하는 형태의 특정 비즈니스 요구 맞추기 가능
  - 외부의 이질적인 개념으로부터 독립성 유지 가능

### 공개 호스트 서비스(Open Host Service)
<img src="resources/ch4img7.png" width="300px">

> 바운디드 컨텍스트에 대한 접근을 제공하는 `프로토콜`이나 `인터페이스`를 정의
- 프로토콜은 바운디드 컨텍스트와 통합하고자 하는 모두가 사용할 수 있도록 `공개`되어 있다
  - `API`로 제공 가능

### 공표된 언어
<img src="resources/ch4img8.png" width="300px">

> 바운디드 컨텍스트의 규모에 관계없이, 모두 간단한 사용과 번역을 가능하게 하는 잘 문서화된 정보 교환 언어
- 공표된 언어는 `XML`, `JSON`, `Protobuf`, `Avro(아브로)` 처럼 좀 더 최적화된 작성 형식으로 정의할 수 있다
- 보통 공개 호스트 서비스는 서드파티에게 최상의 통합 경험을 줄 수 있는 공표된 언어를 제공한다

### 각자의 길(Separate Ways)
<img src="resources/ch4img9.png" width="300px">

> 1개 이상의 바운디드 컨텍스트를 통합으로 다양한 보편언어를 사용하는 것이 유의미한 결과를 제공하지 못하는 상황
- 이 경우에는 바운디드 컨텍스트 내에서 이를 위한 해결 방안을 만들기

### 큰 진흙 덩어리
| 큰 진흙 덩어리                                         | 반부패 계층으로 방어                                      |
|--------------------------------------------------|--------------------------------------------------|
| <img src="resources/ch4img10.png" width="450px"> | <img src="resources/ch4img11.png" width="450px"> |

- 이러한 상황을 만들지 않도록 기를 쓰고 피해야 함
- 큰 진흙 덩어리가 야기하는 문제점들
  - 부적절한 연결과 의존으로 인해 문제를 확산시키는 `에그리게잇`이 증가
  - 한 가지 문제가 해결돼도 또 다른 문제를 계속 야기시킬 수 있음
- `불가피하게 외부의 큰 진흙 덩어리와 반드시 통합해야 한다면, 각 레거시 시스템에 대응한 반부패 계층을 만들어서 자신의 모델을 보호해야 한다`


## 컨텍스트 매핑 활용하기




## 컨텍스트 매핑 사례